<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird - Version GitHub</title>
    <style>
        /* CSS : Pour le style de la page */
        body {
            background-color: #202028; /* Fond gris foncé autour */
            margin: 0;
            display: flex;
            justify-content: center; /* Centre horizontalement */
            align-items: center;     /* Centre verticalement */
            height: 100vh;           /* Prend toute la hauteur de l'écran */
            font-family: 'Courier New', Courier, monospace;
            color: white;
            flex-direction: column;
        }

        /* Le conteneur du jeu (la petite fenêtre) */
        #game-container {
            position: relative;
            border: 10px solid #fff;
            border-radius: 10px;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }

        canvas {
            display: block;
            background-color: #70c5ce;
        }

        h1 { margin-bottom: 10px; font-size: 20px; }
        p { margin-top: 10px; font-size: 14px; color: #aaa; }
    </style>
</head>
<body>

    <h1>Mon Flappy Bird</h1>

    <div id="game-container">
        <canvas id="birdCanvas" width="320" height="480"></canvas>
    </div>

    <p>Appuie sur ESPACE ou Clique pour sauter</p>

    <script>
        const cvs = document.getElementById("birdCanvas");
        const ctx = cvs.getContext("2d");

        let frames = 0;
        
        // --- ETAT DU JEU ---
        const state = {
            current: 0,
            getReady: 0,
            game: 1,
            over: 2
        };

        // --- L'OISEAU ---
        const bird = {
            x: 50,
            y: 150,
            radius: 12,
            speed: 0,
            gravity: 0.25,
            jump: 4.6,
            
            draw: function() {
                ctx.fillStyle = "#FFD700";
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.lineWidth = 2;
                ctx.strokeStyle = "#000";
                ctx.stroke();
                
                // Oeil
                ctx.fillStyle = "#FFF";
                ctx.beginPath();
                ctx.arc(this.x+5, this.y-5, 4, 0, Math.PI*2);
                ctx.fill();
                ctx.fillStyle = "#000";
                ctx.beginPath();
                ctx.arc(this.x+6, this.y-5, 2, 0, Math.PI*2);
                ctx.fill();
            },
            
            flap: function() {
                this.speed = -this.jump;
            },
            
            update: function() {
                if(state.current == state.game) {
                    this.speed += this.gravity;
                    this.y += this.speed;

                    // Sol
                    if(this.y + this.radius >= cvs.height) {
                        this.y = cvs.height - this.radius;
                        state.current = state.over;
                    }
                } else {
                    // Reset position pour le menu
                    if(state.current == state.getReady) {
                        this.y = 150;
                        this.speed = 0;
                    }
                }
            },
            reset: function() {
                this.speed = 0;
                this.y = 150;
            }
        }

        // --- LES TUYAUX ---
        const pipes = {
            position: [],
            w: 50,
            h: 400,
            gap: 120, // Espace pour passer
            dx: 2,
            
            draw: function() {
                for(let i = 0; i < this.position.length; i++) {
                    let p = this.position[i];
                    let topY = p.y;
                    let bottomY = p.y + this.h + this.gap;
                    
                    ctx.fillStyle = "#2e7d32";
                    ctx.fillRect(p.x, topY, this.w, this.h);
                    ctx.fillRect(p.x, bottomY, this.w, this.h);
                    
                    ctx.strokeRect(p.x, topY, this.w, this.h);
                    ctx.strokeRect(p.x, bottomY, this.w, this.h);
                }
            },
            
            update: function() {
                if(state.current !== state.game) return;
                
                if(frames % 100 == 0) {
                    this.position.push({
                        x: cvs.width,
                        y: -150 * (Math.random() + 1)
                    });
                }
                
                for(let i = 0; i < this.position.length; i++) {
                    let p = this.position[i];
                    p.x -= this.dx;
                    
                    // Collisions
                    if(bird.x + bird.radius > p.x && 
                       bird.x - bird.radius < p.x + this.w && 
                       (bird.y - bird.radius < p.y + this.h || bird.y + bird.radius > p.y + this.h + this.gap)) {
                        state.current = state.over;
                    }
                    
                    if(p.x + this.w <= 0) {
                        this.position.shift();
                        score.value += 1;
                    }
                }
            },
            reset: function() {
                this.position = [];
            }
        }

        // --- SCORE ---
        const score = {
            value: 0,
            draw: function() {
                ctx.fillStyle = "#FFF";
                ctx.strokeStyle = "#000";
                
                if(state.current == state.game) {
                    ctx.lineWidth = 2;
                    ctx.font = "35px Arial";
                    ctx.fillText(this.value, cvs.width/2 - 10, 50);
                    ctx.strokeText(this.value, cvs.width/2 - 10, 50);
                } else if(state.current == state.over) {
                    ctx.font = "25px Arial";
                    ctx.fillText("Score: " + this.value, 110, 180);
                    ctx.strokeText("Score: " + this.value, 110, 180);
                    
                    ctx.font = "30px Arial";
                    ctx.fillText("PERDU !", 105, 120);
                    ctx.fillText("Cliquer pour rejouer", 20, 300);
                } else if(state.current == state.getReady) {
                    ctx.font = "30px Arial";
                    ctx.fillText("PRÊT ?", 110, 200);
                    ctx.strokeText("PRÊT ?", 110, 200);
                }
            },
            reset: function() {
                this.value = 0;
            }
        }

        // --- GESTION DES TOUCHES ---
        function action() {
            switch(state.current) {
                case state.getReady:
                    state.current = state.game;
                    break;
                case state.game:
                    bird.flap();
                    break;
                case state.over:
                    pipes.reset();
                    bird.reset();
                    score.reset();
                    state.current = state.getReady;
                    frames = 0;
                    break;
            }
        }
        
        document.addEventListener("click", action);
        document.addEventListener("keydown", function(e) {
            if(e.code === "Space") action();
        });

        // --- BOUCLE DE JEU ---
        function loop() {
            // Fond bleu ciel
            ctx.fillStyle = "#70c5ce";
            ctx.fillRect(0, 0, cvs.width, cvs.height);

            pipes.update();
            pipes.draw();
            
            bird.update();
            bird.draw();
            
            score.draw();
            
            frames++;
            requestAnimationFrame(loop);
        }
        
        loop();
    </script>
</body>
</html>
